---
- name: App Deploy
  hosts:
    - reference
    - production
    - test
    - infra
  connection: local
  roles:
    - role: sys
    - role: dof_mongo
    - role: dof_postgresql
    - role: dof_rabbitmq
    - role: dof_redis
    - role: libreoffice
    - role: maildrop
    - role: storage
      when: WITH_STORAGE is defined and WITH_STORAGE|bool
    - role: hydra
    - role: insights-collector
    - role: insights-cubejs
    - role: insights-engine
    - role: dof_etherpad_nginx
    - role: dof_etherpad
    - role: clamav
    - role: schulcloud-synapse-synchronization
    - role: schulcloud-server-core
    - role: schulcloud-server-ldapsync
      when: WITH_LDAP is defined and WITH_LDAP|bool
    - role: schulcloud-server-ldap
      when: WITH_LDAP_SEPERATION is defined and WITH_LDAP_SEPERATION|bool
    - role: schulcloud-server-tspsync
    - role: schulcloud-server-init
    - role: schulcloud-client-core
    - role: schulcloud-client-ldap
      when: WITH_LDAP_SEPERATION is defined and WITH_LDAP_SEPERATION|bool
    - role: nuxt-client-core
    - role: nuxt-client-ldap
      when: WITH_LDAP_SEPERATION is defined and WITH_LDAP_SEPERATION|bool
    - role: superhero-dashboard
    - role: schulcloud-calendar-core
    - role: schulcloud-calendar-init
    - role: antivirus_check_service
    - role: rocketchat
    - role: ingress
