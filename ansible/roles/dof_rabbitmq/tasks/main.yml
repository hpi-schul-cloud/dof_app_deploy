  - name: RabbitMQ onepassword
    community.kubernetes.k8s:
      kubeconfig: ~/.kube/config
      namespace: "{{ NAMESPACE }}"
      template: onepassword.yaml.j2
    when: ONEPASSWORD is defined and ONEPASSWORD|bool

  - name: RabbitMQ secret
    community.kubernetes.k8s:
      kubeconfig: ~/.kube/config
      namespace: "{{ NAMESPACE }}"
      template: secret.yaml.j2
    when: ONEPASSWORD is undefined or ONEPASSWORD is defined and not ONEPASSWORD


  - name: RabbitMQ Cluster
    community.kubernetes.k8s:
      kubeconfig: ~/.kube/config 
      namespace: "{{ NAMESPACE }}"
      template: rabbitmq.yaml.j2

      
